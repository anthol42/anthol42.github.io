<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<link rel="icon" type="image/x-icon" href="/backtestpro/assets/favicon.ico?">
<link href='/backtestpro/assets/bootstrap.min.css' rel='stylesheet', type='text/css'>
<link href="/backtestpro/assets/style.css" rel="stylesheet" type="text/css">
<script src="/backtestpro/assets/bootstrap.min.js"></script>
<script>
function navigateToUrl(url) {
// Navigate to the URL
window.location.href = url;
}
</script>
<title>backtest.engine.strategy API documentation</title>
<meta name="description" content="" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}#lunr-search{width:100%;font-size:1em;padding:6px 9px 5px 9px;border:1px solid silver}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right;margin-top:4em}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){.module-list{min-height:100vh}#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:80px}.content-container{min-height:100vh}#content{width:70%;max-width:100ch;padding:3em 4em;margin-top:20px;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<nav class="navbar navbar-light navbar-expand bg-light fixed-top shadow-sm" id="navbar-main">
<div class="navbar-container" style="padding-left: 20px">
<a class="navbar-brand logo" href="/backtestpro">
<img alt="Logo image" class="logo__image only-light" src="/backtestpro/assets/logo_light.svg">
</a>
<div class="col-lg-9 navbar">
<div class="mr-auto" id="navbar-center">
<div class="navbar-center-item">
<ul class="navbar-nav" id="navbar-main-elements">
<li class="toctree-l1 nav-item">
<a class="reference internal nav-link" href="/backtestpro">
Home
</a>
</li>
<li class="toctree-l1 nav-item">
<a class="reference internal nav-link" href="/backtestpro/get_started.html">
Get Started
</a>
</li>
<li class="toctree-l1 nav-item">
<a class="reference internal nav-link" href="/backtestpro/tutorials">
Tutorials
</a>
</li>
<li class="toctree-l1 nav-item">
<a class="reference internal nav-link active" href="/backtestpro/docs/backtest">
Documentation
</a>
</li>
<li class="nav-item">
<a class="nav-link nav-external" href="/backtestpro/about.html">About</a>
</li>
</ul>
</div>
</div>
<div id="navbar-end">
<div class="navbar-end-item">
<code class="navbar-version">v0.1.1</code>
</div>
<div class="navbar-end-item">
<ul aria-label="Icon Links" class="navbar-nav" id="navbar-icon-links">
<li class="nav-item">
<a class="nav-link" href="https://github.com/anthol42/backtestPro" rel="noopener" target="_blank"
title="GitHub"><img alt="GitHub" class="icon-link" src="/backtestpro/assets/github-mark.svg"
style="height: 1.2em; margin: 0px; padding: 0px;"></a>
</li>
</ul>
</div>
</div>
</div>
</div>
</nav>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>engine</code></h1>
</header>
<div class="content-container">
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="backtest.engine.strategy.Strategy"><code class="flex name class">
<span>class <span class="ident">Strategy</span></span>
</code></dt>
<dd>
<div class="desc"><p>This is the base class of strategies.
To create a strategy, you should inherit from this class and implement the
run method.
The run method is called at each time step to compute the strategy.
You can also override the <strong>init</strong>
method to add attributes to the strategy.
If you do so, you should also override the save and load methods to save
the strategy in a different format (by default it is pickle).</p>
<h2 id="warning">Warning</h2>
<p>You should not override the init and the <strong>call</strong> method.
The init, and notice it doesn't have
the underscores like <strong>init</strong>, is used to bind the strategy to the backtest object.
This is done under the
hood.
The <strong>call</strong> method is used to dispatch the data to the run method.
Overriding it might ignore some
safety checks or statistics calculations.</p>
<p><strong>While implementing the run method:</strong></p>
<p>You SHOULD NOT change the state of the account, the portfolio or the broker with the exception of calling the
methods below on the broker object.
If you modify the state of one of these objects, you could encounter bugs
and false backtest results.
The only methods you should call on the broker object are:
- broker.buy_long(&hellip;)
- broker.sell_long(&hellip;)
- broker.buy_short(&hellip;)
- broker.sell_short(&hellip;)</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>account</code></strong></dt>
<dd>The account object</dd>
<dt><strong><code>broker</code></strong></dt>
<dd>The broker object</dd>
<dt><strong><code>available_time_res</code></strong></dt>
<dd>The available time resolutions</dd>
<dt><strong><code>portfolio</code></strong></dt>
<dd>The portfolio object (Alias of broker.portfolio)</dd>
</dl>
<h2 id="example">Example</h2>
<pre><code class="language-python-repl">&gt;&gt;&gt; class MyStrategy(Strategy):
... def run(self, data, timestep):
...    for ticker in data.main.tickers:
...        chart = data.main[ticker].chart
...        if len(chart) &gt; 2 and F.crossover(chart[&quot;MACD&quot;], chart[&quot;MACD_SIGNAL&quot;]) and chart[&quot;MACD&quot;].iloc[-1] &lt; 0:
...            if ticker not in self.broker.portfolio.long:
...                self.broker.buy_long(ticker, 500)
...        if ticker in self.broker.portfolio.long and F.crossunder(chart[&quot;MACD&quot;], chart[&quot;MACD_SIGNAL&quot;]):
...            self.broker.sell_long(ticker, 500)
...
</code></pre></div>
<h3>Parent</h3>
<ul class="hlist">
<li>abc.ABC</li>
</ul>
<h3>Static methods</h3>
<dl>
<dt id="backtest.engine.strategy.Strategy.load"><code class="name flex">
<span>def <span class="ident">load</span></span>(<span>path:Â pathlib.PurePath)</span>
</code></dt>
<dd>
<div class="desc"><p>This method is used to load the state of a strategy from a file.
If you would like to save in an other format,
you can override this method and the save method.</p>
<h2 id="args">Args:</h2>
<p><strong><code>path</code></strong>: The path to load the strategy from.
(.pkl)
</p></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="backtest.engine.strategy.Strategy.init"><code class="name flex">
<span>def <span class="ident">init</span></span>(<span>self, account:Â <a title="backtest.engine.account.Account" href="account.html#backtest.engine.account.Account">Account</a>, broker:Â <a title="backtest.engine.broker.Broker" href="broker.html#backtest.engine.broker.Broker">Broker</a>, available_time_res:Â List[datetime.timedelta])</span>
</code></dt>
<dd>
<div class="desc"><p>YOU SHOULD NOT OVERRIDE THIS METHOD</p>
<h2 id="args">Args:</h2>
<p><strong><code>account</code></strong>: The account object<br>
<strong><code>broker</code></strong>: The broker object<br>
<strong><code>available_time_res</code></strong>: The available time resolutions
</p></div>
</dd>
<dt id="backtest.engine.strategy.Strategy.run"><code class="name flex">
<span>def <span class="ident">run</span></span>(<span>self, data:Â <a title="backtest.engine.record.RecordsBucket" href="record.html#backtest.engine.record.RecordsBucket">RecordsBucket</a>, timestep:Â datetime.datetime)</span>
</code></dt>
<dd>
<div class="desc"><p>This method is used to compute the strategy at each time step.
It is in this method that the strategy logic is
implemented.</p>
<h2 id="args">Args:</h2>
<p><strong><code>data</code></strong>: The data to use for the strategy<br>
<strong><code>timestep</code></strong>: The current time step
</p></div>
</dd>
<dt id="backtest.engine.strategy.Strategy.save"><code class="name flex">
<span>def <span class="ident">save</span></span>(<span>self, path:Â pathlib.PurePath)</span>
</code></dt>
<dd>
<div class="desc"><p>This method is used to save the state of the strategy to a file.
If you would like to save in another format,
you can override this method and the load method.</p>
<h2 id="note">Note</h2>
<p>To avoid saving things twice, we set the account, broker and available_time_res to None before saving.
Only the other attributes will be saved.
(If any)</p>
<h2 id="args">Args:</h2>
<p><strong><code>path</code></strong>: The path to save the strategy (.pkl)
</p></div>
</dd>
</dl>
</dd>
</dl>
</section>
</div>
</article>
<nav id="sidebar">
<form>
<input id="lunr-search" name="q" placeholder="ðŸ”Ž Search ..." aria-label="Search"
disabled minlength="2">
</form>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/tingle/0.15.3/tingle.min.css" integrity="sha512-j1u8eUJ4f23xPPxwOrLUPQaCD2dwzNqqmDDcWS4deWsMv2ohLqmXXuP3hU7g8TyzbMSakP/mMqoNBYWj8AEIFg==" crossorigin>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tingle/0.15.3/tingle.min.js" integrity="sha512-plGUER9JkeEWPPqQBE4sdLqBoQug5Ap+BCGMc7bJ8BXkm+VVj6QzkpBz5Yv2yPkkq+cqg9IpkBaGCas6uDbW8g==" crossorigin></script>
<style>
.modal-box iframe {
width: 100vw;
height: calc(100vh - 80px);
}
@media screen and (min-width: 700px) {
.modal-box iframe {
width: 70vw;
height: 80vh;
}
}
.modal-box .tingle-modal-box {width: auto;}
.modal-box .tingle-modal-box__content {padding: 0;}
</style>
<script>
const input = document.getElementById('lunr-search');
input.disabled = false;
input.form.addEventListener('submit', (ev) => {
ev.preventDefault();
const url = new URL(window.location);
url.searchParams.set('q', input.value);
history.replaceState({}, null, url.toString());
search(input.value);
});
const query = new URL(window.location).searchParams.get('q');
if (query)
search(query);
function search(query) {
const url = '../../doc-search.html#' + encodeURIComponent(query);
new tingle.modal({
cssClass: ['modal-box'],
onClose: () => {
const url = new URL(window.location);
url.searchParams.delete('q');
history.replaceState({}, null, url.toString());
setTimeout(() => input.focus(), 100);
}
}).setContent('<div class="embed-responsive embed-responsive-16by9"><iframe class="embed-responsive-item" src="' + url + '"></iframe></div>').open();
}
</script>
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Path</h3>
<ul>
<li><code><div><a title="backtest" href="../index.html">backtest</a>.<a title="backtest.engine" href="index.html">engine</a>.<a title="backtest.engine.strategy" href="#backtest.engine.strategy">strategy</a></div></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<div class="accordion" id="classes-accordion">
<div class="accordion-item">
<h4 class="accordion-header">
<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse_%3CClass+%27backtest.engine.strategy.Strategy%27%3E" aria-expanded="false" aria-controls="collapse_%3CClass+%27backtest.engine.strategy.Strategy%27%3E" onclick="navigateToUrl('#backtest.engine.strategy.Strategy')">
<code>Strategy</code>
</button>
</h4>
<div id="collapse_%3CClass+%27backtest.engine.strategy.Strategy%27%3E" class="accordion-collapse collapse" data-bs-parent="#classes-accordion">
<div class="accordion-body">
<ul class="">
<li><code><a title="backtest.engine.strategy.Strategy.init" href="#backtest.engine.strategy.Strategy.init">init</a></code></li>
<li><code><a title="backtest.engine.strategy.Strategy.load" href="#backtest.engine.strategy.Strategy.load">load</a></code></li>
<li><code><a title="backtest.engine.strategy.Strategy.run" href="#backtest.engine.strategy.Strategy.run">run</a></code></li>
<li><code><a title="backtest.engine.strategy.Strategy.save" href="#backtest.engine.strategy.Strategy.save">save</a></code></li>
</ul>
</div>
</div>
</div>
</div>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<div id="footer_container">
<p><b>Author</b>: Anthony Lavertu (2024)</p>
<p><b>Generated by</b> <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</div>
</footer>
</body>
</html>